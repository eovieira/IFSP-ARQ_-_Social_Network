<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/style.css">
    <title>
        {% if user.bloqueados.filter_by(id_bloqueado=current_user.id).first() %}
            Usuário não encontrado
        {% else %}
            Perfil de {{ user.username }}
        {% endif %}
    </title>
</head>

<body>
    <header>
        <div class="container">
            <img src="https://upload.wikimedia.org/wikipedia/commons/7/78/Instituto_Federal_de_S%C3%A3o_Paulo_-_Marca_Vertical_2015.svg"
                class='logo-img'>
            <p class='center-title'>
                {% if user.bloqueados.filter_by(id_bloqueado=current_user.id).first() %}
                    Usuário não encontrado
                {% else %}
                    Perfil de {{ user.username }}
                {% endif %}
            </p>
            <nav>
                <ul class='menu'>
                    {% if current_user.is_authenticated %}
                    <li><a href="{{ url_for('perfil', username=current_user.username) }}">
                            @{{ current_user.username.lower() }}</a>
                    </li>
                    {% if current_user.cargo == 'Administrador' %}
                    <li><a href="{{ url_for('admin_panel') }}">Admin</a></li>
                    {% endif %}
                    <li><a class="sair" href="{{ url_for('logout') }}">Sair</a></li>
                    {% else %}
                    <li><a href="{{ url_for('login') }}">Fazer login</a></li>
                    <li><a href="{{ url_for('registrar') }}">Registrar-se</a></li>
                    {% endif %}
                </ul>
            </nav>
        </div>
    </header>
    <form>
    {% if user.bloqueados.filter_by(id_bloqueado=current_user.id).first() %}
    <p>As informações do usuário não podem ser exibidas</p>
    {% elif current_user.bloqueados.filter_by(id_bloqueado=user.id).first() %}
        <p>Seguidores: {{ quantia_seguidores }}, Seguindo: {{ quantia_seguindo }}</p>
        <p>Você bloqueou {{ user.username }}</p>
        <form>
            <a href="{{ url_for('desbloquear', username=user.username)}}"><span id="unblock">Desbloquear</span></a>
        </form>

    {% else %}
        <p>Seguidores: {{ quantia_seguidores }}, Seguindo: {{ quantia_seguindo }}</p>
        {% if user.id != current_user.id %}
            
                {% if current_user.seguindo.filter_by(id_seguido=user.id).first() %}
                <a href="{{ url_for('deixar_de_seguir', username=user.username)}}">Deixar de seguir</a>
                {% else %}
                <a href="{{ url_for('seguir', username=user.username)}}">Seguir</a>
                {% endif %}

        {% if not current_user.bloqueados.filter_by(id_bloqueado=user.id).first() %}
            <a href="{{ url_for('bloquear', username=user.username)}}"><span id="block">Bloquear</span></a>
        
        {% endif %}
        {% endif %}
        
        <p>Seguindo:</p>
        <ul class="seguindo">
            {% for seguido in seguindo %}
            <li>{{ seguido.username }}</li>
            {% endfor %}
        </ul>

        <p>Seguidores:</p>
        <ul class="seguidores">
            {% for seguidor in seguidores %}
            <li>{{ seguidor.username }}</li>
            {% endfor %}
        </ul>
    {% endif %}
    </form>
</body>

</html>
